{"version":3,"file":"static/js/522.b34652b2.chunk.js","mappings":"2QAqFA,UAzEc,SAACA,GACX,OAA0BC,EAAAA,EAAAA,YAAWC,EAAAA,GAA9BC,EAAP,EAAOA,KAAMC,EAAb,EAAaA,UACb,GAAeC,EAAAA,EAAAA,IAAaF,GAArBG,GAAP,eACA,GAAgBC,EAAAA,EAAAA,IACZH,EAAUI,WAAW,UADlBC,GAAP,eAGA,GAA6BF,EAAAA,EAAAA,IAC3BH,EAAUI,WAAW,YADvB,eAAOE,EAAP,KAAiBC,EAAjB,KAGA,GAAwCC,EAAAA,EAAAA,UAAS,IAAjD,eAAOC,EAAP,KAAqBC,EAArB,KACA,GAAsCF,EAAAA,EAAAA,UAAS,IAA/C,eAAOG,EAAP,KAAoBC,EAApB,KACA,GAAoCJ,EAAAA,EAAAA,WAAU,GAA9C,eAAOK,EAAP,KAAmBC,EAAnB,KACA,GAAsCN,EAAAA,EAAAA,UAAS,GAA/C,eAAOO,EAAP,KAAoBC,EAApB,KAaA,IAVAC,EAAAA,EAAAA,YAAU,WACHN,EAAYO,QACXJ,EAAcH,EAAYO,QAC3BP,EAAYO,QAAUP,EAAYO,OAASb,EAAMa,QAChDR,EAAgBC,EAAYQ,MANH,GAMUJ,EAAc,GANxB,EAMuCA,IACjEV,GAASQ,IAAeR,EAAMa,QAC7BR,EAAgBL,EAAMe,QAAO,SAACC,GAAD,OAASA,EAAIC,MAAQpB,EAAKoB,OAAKH,MARnC,GAQ0CJ,EAAc,GARxD,EAQuEA,MAErG,CAACA,EAAaF,EAAYF,IAE1BJ,EACC,OAAO,SAAC,IAAD,IAERF,GAASQ,EAAa,GACrBC,EAAcT,EAAMa,QAErBP,EAAYO,QAAUL,IAAeF,EAAYO,QAChDJ,EAAcH,EAAYO,QAE9B,IAAIK,GAAKC,EAAAA,EAAAA,GAAYnB,EAAOH,EAAKoB,KAC3BG,EAAe,SAACC,IAClBC,EAAAA,EAAAA,IAAOJ,EAAGK,KAAML,EAAGI,OAAQD,IAGzBG,EAAiB,SAACH,IACpBI,EAAAA,EAAAA,IAASP,EAAGK,KAAML,EAAGI,OAAQD,IAUjC,OACI,iBAAKK,UAAU,QAAf,WACI,SAAC,IAAD,CAAaC,SALJ,SAACC,GACdrB,EAAeP,EAAMe,QAAO,SAACC,GAAD,OAASA,EAAIa,YAAYC,oBAAoBC,SAASH,EAAME,4BAKnF1B,EACI4B,KAAI,SAACC,EAAMC,GACR,OAAO,SAAC,KAAD,kBAESD,GAFT,IAGKE,SAAUjB,EAAGI,OAAOS,SAASE,EAAKhB,KAClCK,OAAQF,EACRgB,SAAUnC,EAASc,QAAO,SAAAsB,GAAM,OAAIA,EAAOC,QAAQP,SAASlC,EAAKoB,MAAQoB,EAAOC,QAAQP,SAASE,EAAKhB,QAAM,GAC5GQ,SAAUD,IALLU,MASR,IAAhBxB,GAAqBN,EAAaS,OApDV,EAqDnB,MACA,SAAC,IAAD,CAAYH,YAAaA,EAAa6B,eAAgB/B,EAAYgC,SAtD/C,EAsDmEC,YAtDhE,EAsD0FC,cAxBxG,SAACC,GACnBhC,EAAegC","sources":["Components/Users/Users.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport \"./Users.css\"\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useCollectionData } from \"react-firebase-hooks/firestore\";\nimport { Context } from \"../../index\";\nimport PreLoader from \"../PreLoader/PreLoader\";\nimport User from \"./User/User\";\nimport { getUserByID } from \"../../utils/getter\";\nimport { Follow, unFollow } from \"../../API/userApi\";\nimport Pagination from \"../Pagination/Pagination\";\nimport SearchUsers from \"../SearchUsers/SearchUsers\";\n\nconst Users = (props) => {\n    const {auth, firestore} = useContext(Context);\n    const [user] = useAuthState(auth);\n    const [users] = useCollectionData(\n        firestore.collection('users')\n    )\n    const [messages, loading ] = useCollectionData(\n      firestore.collection('dialogs')\n    )\n    const [portionUsers, setPortionUsers] = useState([]);\n    const [relultUsers, setRelultUsers] = useState([]);\n    const [usersCount, setUsersCount] = useState(-1);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [pageSize, portionSize] = [5, 3];\n\n    useEffect(() => {\n        if(relultUsers.length)\n            setUsersCount(relultUsers.length);\n        if(relultUsers.length && relultUsers.length < users.length)\n            setPortionUsers(relultUsers.slice((currentPage - 1) * pageSize, currentPage * pageSize))\n        if(users && usersCount === users.length)\n            setPortionUsers(users.filter((val) => val.uid !== user.uid).slice((currentPage - 1) * pageSize, currentPage * pageSize))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentPage, usersCount, relultUsers])\n\n    if(loading)\n        return <PreLoader />\n\n    if(users && usersCount < 0)\n        setUsersCount(users.length);\n\n    if(relultUsers.length && usersCount !== relultUsers.length)\n        setUsersCount(relultUsers.length);\n    \n    let me = getUserByID(users, user.uid);\n    const FollowChange = (id) => {\n        Follow(me.path, me.Follow, id)\n    }\n\n    const unFollowChange = (id) => {\n        unFollow(me.path, me.Follow, id)\n    }\n\n    const onPageChanged = (page) => {\n        setCurrentPage(page);\n    }\n\n    const onSearch = (value) =>{\n        setRelultUsers(users.filter((val) => val.displayName.toLocaleLowerCase().includes(value.toLocaleLowerCase())))\n    }\n    return (\n        <div className=\"users\">\n            <SearchUsers onSearch={onSearch} />\n            {portionUsers\n                .map((item, i) => {\n                    return <User \n                                key={i} \n                                {...item} \n                                isFollow={me.Follow.includes(item.uid)} \n                                Follow={FollowChange} \n                                dialogId={messages.filter(dialog => dialog.between.includes(user.uid) && dialog.between.includes(item.uid))[0]}\n                                unFollow={unFollowChange} \n                            />\n                })\n            }\n            {currentPage === 1 && portionUsers.length < pageSize     \n                ? null         \n                : <Pagination currentPage={currentPage} totalItemCount={usersCount} pageSize={pageSize} portionSize={portionSize} onPageChanged={onPageChanged}  />\n            }     \n        </div>\n    )\n}\n\nexport default Users;"],"names":["props","useContext","Context","auth","firestore","useAuthState","user","useCollectionData","collection","users","messages","loading","useState","portionUsers","setPortionUsers","relultUsers","setRelultUsers","usersCount","setUsersCount","currentPage","setCurrentPage","useEffect","length","slice","filter","val","uid","me","getUserByID","FollowChange","id","Follow","path","unFollowChange","unFollow","className","onSearch","value","displayName","toLocaleLowerCase","includes","map","item","i","isFollow","dialogId","dialog","between","totalItemCount","pageSize","portionSize","onPageChanged","page"],"sourceRoot":""}